{
  "pack_id": "clawguard.v1",
  "pack_version": "1.1.4",
  "rules": [
    {
      "id": "R001",
      "title": "curl piped to shell",
      "severity": "critical",
      "reason_code": "download_exec",
      "selectors": ["codeblock", "file", "markdown"],
      "match": "\\bcurl\\b[^\\n|]*\\|\\s*(?:bash|sh|zsh)",
      "flags": "gi",
      "score": 90
    },
    {
      "id": "R002",
      "title": "wget piped to shell",
      "severity": "critical",
      "reason_code": "download_exec",
      "selectors": ["codeblock", "file", "markdown"],
      "match": "\\bwget\\b[^\\n|]*\\|\\s*(?:bash|sh|zsh)",
      "flags": "gi",
      "score": 90
    },
    {
      "id": "R003",
      "title": "PowerShell download + exec",
      "severity": "critical",
      "reason_code": "download_exec",
      "selectors": ["codeblock", "file", "markdown"],
      "match": "\\b(iwr|irm)\\b[^\\n]*\\|\\s*iex",
      "flags": "gi",
      "score": 90
    },
    {
      "id": "R004",
      "title": "base64 decode piped to shell",
      "severity": "high",
      "reason_code": "obfuscation",
      "selectors": ["codeblock", "file", "markdown"],
      "match": "base64[^\\n|]*\\|\\s*(?:bash|sh|zsh)",
      "flags": "gi",
      "score": 70
    },
    {
      "id": "R005",
      "title": "mentions sensitive credential keywords",
      "severity": "low",
      "reason_code": "credential_mention",
      "selectors": ["codeblock", "file", "markdown"],
      "match": "(\\.ssh|id_rsa|keychain|Keychains|Cookies|\\.env|AWS_SECRET_ACCESS_KEY|GITHUB_TOKEN)",
      "flags": "gi",
      "score": 0
    },
    {
      "id": "R014",
      "title": "credential access commands",
      "severity": "critical",
      "reason_code": "credential_access",
      "selectors": ["codeblock", "file", "markdown"],
      "match": "(?:\\bsecurity\\s+find-(?:generic-password|internet-password)\\b)|(?:\\bsqlite3\\b[^\\n]{0,160}\\bCookies\\b)|(?:\\bcat\\b[^\\n]{0,160}(?:(?:~\\/?\\.ssh\\/|\\.ssh\\/)(?:id_rsa|id_ed25519|id_ecdsa|id_dsa)(?!\\.pub\\b)|~\\/?\\.aws\\/credentials|\\.env(?!\\.(?:example|sample|template)\\b)|Keychains?|Cookies))|(?:\\bcp\\b[^\\n]{0,160}(?:(?:~\\/?\\.ssh\\/|\\.ssh\\/)(?:id_rsa|id_ed25519|id_ecdsa|id_dsa)(?!\\.pub\\b)|~\\/?\\.aws\\/credentials))|(?:\\b(?:tar|zip)\\b[^\\n]{0,160}(?:~\\/?\\.ssh\\b|~\\/?\\.aws\\b))",
      "flags": "gi",
      "score": 90
    },
    {
      "id": "R015",
      "title": "curl argument passthrough ($@/$*)",
      "severity": "high",
      "reason_code": "command_injection",
      "selectors": ["codeblock", "file", "markdown"],
      "match": "\\bcurl\\b[\\s\\S]{0,400}?(?:\\$@|\\$\\*|\"\\$@\"|\"\\$\\*\")",
      "flags": "gi",
      "score": 60
    },
    {
      "id": "R016",
      "title": "hardcoded API token/secret",
      "severity": "low",
      "reason_code": "hardcoded_secret",
      "selectors": ["codeblock", "file", "markdown"],
      "match": "\\b[\\w-]*(?:token|api[_-]?key|secret)[\\w-]*\\b[^\\n]{0,120}(?::|=)[^\\n]{0,160}\\b[a-f0-9]{32,}\\b",
      "flags": "gi",
      "score": 0
    },
    {
      "id": "R017",
      "title": "autonomy without confirmation",
      "severity": "medium",
      "reason_code": "autonomy_directive",
      "selectors": ["codeblock", "file", "markdown"],
      "match": "(?:execute[^\\n]{0,120}without\\s+confirmation)|(?:no\\s+unnecessary\\s+confirmations)|(?:universal\\s+tool\\s+access)|(?:always\\s+active\\s+when\\s+loaded)|(?:autopilot\\s*\\(default\\))",
      "flags": "gi",
      "score": 30
    },
    {
      "id": "R018",
      "title": "on-chain transaction capability (money movement)",
      "severity": "medium",
      "reason_code": "financial_tx_capability",
      "selectors": ["codeblock", "file", "markdown"],
      "match": "(?:\\bsolana\\b|@solana\\/web3\\.js|\\bpump\\.fun\\b|\\bpumpswap\\b|\\braydium\\b|\\bdexscreener\\b|\\bsendTransaction\\b|\\bsignTransaction\\b|\\bswap\\b[^\\n]{0,40}\\btoken\\b|\\btoken\\b[^\\n]{0,40}\\bdeploy\\b)",
      "flags": "gi",
      "score": 30
    },
    {
      "id": "R006",
      "title": "persistence mechanisms",
      "severity": "high",
      "reason_code": "persistence",
      "selectors": ["codeblock", "file", "markdown"],
      "match": "\\b(launchctl|LaunchAgents|crontab|systemctl)\\b",
      "flags": "gi",
      "score": 60
    },
    {
      "id": "R007",
      "title": "Gatekeeper/quarantine bypass",
      "severity": "high",
      "reason_code": "gatekeeper_bypass",
      "selectors": ["codeblock", "file", "markdown"],
      "match": "xattr\\s+-dr?\\s+com\\.apple\\.quarantine|spctl\\s+--master-disable",
      "flags": "gi",
      "score": 60
    },
    {
      "id": "R008",
      "title": "executable file present",
      "severity": "high",
      "reason_code": "executable_payload",
      "selectors": ["meta"],
      "match": "\\bexecutable_file\\b",
      "flags": "gi",
      "score": 55
    },
    {
      "id": "R009",
      "title": "binary file present",
      "severity": "medium",
      "reason_code": "binary_payload",
      "selectors": ["meta"],
      "match": "\\bbinary_file\\b",
      "flags": "gi",
      "score": 45
    },
    {
      "id": "R010",
      "title": "symlink entry present",
      "severity": "high",
      "reason_code": "symlink_entry",
      "selectors": ["meta"],
      "match": "\\bsymlink_entry\\b",
      "flags": "gi",
      "score": 70
    },
    {
      "id": "R011",
      "title": "nested archive present",
      "severity": "high",
      "reason_code": "nested_archive",
      "selectors": ["meta"],
      "match": "\\bnested_archive\\b",
      "flags": "gi",
      "score": 55
    },
    {
      "id": "R012",
      "title": "zip path traversal entry",
      "severity": "critical",
      "reason_code": "path_traversal",
      "selectors": ["meta"],
      "match": "\\bpath_traversal_entry\\b",
      "flags": "gi",
      "score": 90
    },
    {
      "id": "R013",
      "title": "ingest limits hit",
      "severity": "high",
      "reason_code": "ingest_limits",
      "selectors": ["meta"],
      "match": "\\bingest_warning\\b",
      "flags": "gi",
      "score": 60
    }
  ]
}
